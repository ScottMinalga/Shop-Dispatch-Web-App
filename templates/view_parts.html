{% extends "base.html" %}

{% block content %}
<h1>Parts</h1>

<!-- Table section -->
<table class="table">
  <thead>
    <tr>
      <th>Part Number</th>
      <th>Project Number</th>
      <th>Job Number</th>
      <th>Sales Order</th>
      <th>Vendor Name</th>
      <th>Status</th>
      <th>Notes</th>
      <th>Ship Date</th>
      <th>Order Quantity</th>
    </tr>
    <tr>
      <th><input type="text" id="filterPartNumber" placeholder="Filter"></th>
      <th><input type="text" id="filterProjectNumber" placeholder="Filter"></th>
      <th><input type="text" id="filterJobNumber" placeholder="Filter"></th>
      <th><input type="text" id="filterSalesOrder" placeholder="Filter"></th>
      <th><input type="text" id="filterVendorName" placeholder="Filter"></th>
      <th><input type="text" id="filterStatus" placeholder="Filter"></th>
      <th><input type="text" id="filterNotes" placeholder="Filter"></th>
      <th><input type="text" id="filterShipDate" placeholder="Filter"></th>
      <th><input type="text" id="filterOrderQuantity" placeholder="Filter"></th>
    </tr>
  </thead>
  <tbody>
    {% for part in parts %}
    <tr>
      <td>{{ part.part_number }}</td>
      <td>{{ part.project_number }}</td>
      <td>{{ part.job_number }}</td>
      <td>{{ part.sales_order }}</td>
      <td>{{ part.vendor_name }}</td>
      <td>{{ part.status }}</td>
      <td>{{ part.notes }}</td>
      <td>{{ part.ship_date }}</td>
      <td>{{ part.order_quantity }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- JavaScript for filtering -->
<script>
  function filterTable() {
  const filterValues = {
    partNumber: $("#filterPartNumber").val().toLowerCase(),
    projectNumber: $("#filterProjectNumber").val().toLowerCase(),
    jobNumber: $("#filterJobNumber").val().toLowerCase(),
    salesOrder: $("#filterSalesOrder").val().toLowerCase(),
    vendorName: $("#filterVendorName").val().toLowerCase(),
    status: $("#filterStatus").val().toLowerCase(),
    notes: $("#filterNotes").val().toLowerCase(),
    shipDate: $("#filterShipDate").val().toLowerCase(),
    orderQuantity: $("#filterOrderQuantity").val().toLowerCase()
  };

  $("table tbody tr").each(function() {
    let show = true;

    const partNumber = $(this).find("td:eq(0)").text().toLowerCase();
    const projectNumber = $(this).find("td:eq(1)").text().toLowerCase();
    const jobNumber = $(this).find("td:eq(2)").text().toLowerCase();
    const salesOrder = $(this).find("td:eq(3)").text().toLowerCase();
    const vendorName = $(this).find("td:eq(4)").text().toLowerCase();
    const status = $(this).find("td:eq(5)").text().toLowerCase();
    const notes = $(this).find("td:eq(6)").text().toLowerCase();
    const shipDate = $(this).find("td:eq(7)").text().toLowerCase();
    const orderQuantity = $(this).find("td:eq(8)").text().toLowerCase();

    if (partNumber.indexOf(filterValues.partNumber) === -1 ||
        projectNumber.indexOf(filterValues.projectNumber) === -1 ||
        jobNumber.indexOf(filterValues.jobNumber) === -1 ||
        salesOrder.indexOf(filterValues.salesOrder) === -1 ||
        vendorName.indexOf(filterValues.vendorName) === -1 ||
        status.indexOf(filterValues.status) === -1 ||
        notes.indexOf(filterValues.notes) === -1 ||
        shipDate.indexOf(filterValues.shipDate) === -1 ||
        orderQuantity.indexOf(filterValues.orderQuantity) === -1) {
      show = false;
    }

    $(this).toggle(show);
  });
}

// Attach filterTable function to input events
$("input[id^='filter']").on("input", filterTable);
</script>
{% endblock %}